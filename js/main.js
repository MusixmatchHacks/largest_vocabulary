!function(){function a(a,b){this.data=b,b.sort(c("num_artists")),this.$chart=$("#"+a.allChartCssId),this.addArtistsToChart()}function b(a){return a.split(" ").join("_")}function c(a){return function(b,c){if("object"==typeof b&&"object"==typeof c){var d=b[a],e=c[a];return d===e?0:typeof propetyValueM==typeof propertyVaueN?e>d?1:-1:e>typeof d?1:-1}throw{type:"Error",message:"Expected objects got something else"}}}window.AllArtists={},window.AllArtists.createChart=function(b,c){return new a(b,c)},a.prototype={sortNames:function(a){a.sort();var c=[],d=a[0][0],e=0;return a.forEach(function(a){a[0]===d?0===c.length?c.push({startingLetter:d,names:[b(a)]}):c[e].names.push(b(a)):(d=a[0],e++,c[e]={startingLetter:d,names:[b(a)]})}),c},addArtistsToChart:function(){var a=Handlebars.compile(this.$chart.children("#template-allArtists").html());this.$chart.append(a(this.data))}}}(),!function(){function a(a,b){this.name=a,this.data=b,this.selector=a.split(" ").join("_"),this.$artist=$("#"+this.selector),this.$artist.css("background-image","url(img/artist_images_40px/"+this.selector+".jpg)"),this.tooltipTemplate=$.trim($("#tooltipTemplate").html()),this.numArtists=93,this.tooltipStates={COMPACT:1,EXPANDED:2},this.currentTooltipState=this.tooltipStates.COMPACT,this.tooltipOriginalContent=$("#tooltipTemplate").html().replace(/{{rank}}/i,this.data.rank_vocab).replace(/{{artistName}}/i,"The Black Eyed Peas"===this.data.name?"T.B.E.P":this.data.name).replace(/{{vocab}}/i,window.VocabPlot.formatWithCommas(this.data.vocab_len)).replace(/{{total}}/i,this.numArtists),this.tooltipExpandedContent=$("#tooltipTemplateExpanded").html().replace(/{{rank}}/i,this.data.rank_vocab).replace(/{{artistName}}/i,"The Black Eyed Peas"===this.data.name?"T.B.E.P":this.data.name).replace(/{{vocab}}/i,window.VocabPlot.formatWithCommas(this.data.vocab_len)).replace(/{{total}}/i,this.numArtists).replace(/{{sales}}/i,this.data.certified_sales).replace(/{{rank_sales}}/i,this.data.rank_sales).replace(/{{learning_rate}}/i,Math.floor(this.data.learning_rate)),this.events.hover.call(this),this.events.click.call(this)}window.Artist={},window.Artist.newArtist=function(b,c){return new a(b,c)},a.prototype={dim:function(){this.$artist.removeClass("normalArtist"),this.$artist.addClass("dimArtist")},undim:function(){this.$artist.removeClass("dimArtist"),this.$artist.addClass("normalArtist")},highlight:function(){this.$artist.hasClass("highlightedArtist")||(this.$artist.addClass("highlightedArtist"),this.$artist.tipsy("show"))},unhighlight:function(){this.$artist.hasClass("highlightedArtist")&&(this.$artist.removeClass("highlightedArtist"),this.$artist.tipsy("hide"))}},a.prototype.events={click:function(){},hover:function(){var a=this;this.$artist.tipsy({gravity:"Eminem"===a.data.name?"n":"s",html:!0,opacity:1,offset:3,title:function(){return a.tooltipExpandedContent}})}}}(),!function(){var a=$(window);expandButton={init:function(a){this.button=a.button,this.target=a.target,this.initialButtonPos=this.button.offset(),this.scrollLimits=this.target.offset(),this.button.on("click",this.expandListToggle)},expandListToggle:function(){expandButton.target.toggleClass("expanded"),expandButton.target.hasClass("expanded")?(expandButton.target.children(".overlay").remove(),$(this).text("Show less")):(expandButton.target.prepend($("<div></div>",{"class":"overlay"})),$(this).text("Show all"),a.scrollTop()>expandButton.getLowerScrollLimit()&&a.scrollTop(1100))},getUpperScrollLimit:function(){return this.scrollLimits.top},getLowerScrollLimit:function(){return this.scrollLimits.top+this.target.height()-this.button.height()-100}},a.on("scroll",function(){var b=a.scrollTop();b>expandButton.getUpperScrollLimit()&&b<expandButton.getLowerScrollLimit()?(expandButton.button.addClass("buttonFixedScroll"),expandButton.button.css({top:expandButton.initialButtonPos.top-532+"px",left:expandButton.initialButtonPos.left+"px"})):(expandButton.button.removeClass("buttonFixedScroll"),expandButton.button.offset(expandButton.initialButtonPos))})}(),!function(){function a(a){return function(b,c){if("object"==typeof b&&"object"==typeof c){var d=b[a],e=c[a];return d===e?0:typeof propetyValueM==typeof propertyVaueN?e>d?1:-1:e>typeof d?1:-1}throw{type:"Error",message:"Expected objects got something else"}}}window.GenrePlot={init:function(b){this.data=genre_data,this.data.sort(a("avg_vocab")),this.container=b.container,this.scaleContainer=d3.select("#"+b.scaleContainerCssId),this.legendContainer=d3.select("#"+b.legendContainerCssId),this.xScale=d3.scale.linear().domain([0,d3.max(this.data,function(a){return a.avg_vocab})]).range([0,$("#"+b.scaleContainerCssId).width()]),b.namesContainer.append(Handlebars.compile(b.genreNameTemplate)(this.data)),this.scaleContainer.style("height",this.container.height()+"px"),this.drawPlot([500,2e3,3500,5e3]);var c=$(window),d=$("#"+b.legendContainerCssId),e=d.offset(),f=this;c.on("scroll",function(){var a=f.container.offset(),b=a.top,g=b+f.container.height()-30,h=c.scrollTop();h>b&&g>h?d.css({position:"fixed",top:"30px",left:e.left}):d.css({position:"absolute",top:a.top-300})})},drawPlot:function(a){this.drawBars(),this.drawScale(a),this.drawSeparators(),this.drawScaleLegend(a)},drawScale:function(a){var b=this,c="#303030";this.scaleContainer.selectAll("line").data(a).enter().append("line").attr("x1",function(a){return b.xScale(a)}).attr("x2",function(a){return b.xScale(a)}).attr("y1",0).attr("y2",this.container.height()).style("stroke",c).style("stroke-width",1)},drawScaleLegend:function(a){var b=this,c=100,d=30,e="#303030",f="#FFFFFF",g=8;this.legendContainer.selectAll("rect").data(a).enter().append("rect").attr("x",function(a){return b.xScale(a)-.5}).attr("y",0).attr("width",c).attr("height",d).style("fill",e),this.legendContainer.selectAll("text").data(a).enter().append("text").attr("x",function(a){return b.xScale(a)+g}).attr("y",21).text(function(a){return a+" WORDS"}).attr("fill",f).style("font-family","Oswald")},drawBars:function(){var a=this,b=25,c=30,d=13,e="#D6C06D";this.scaleContainer.selectAll("rect").data(this.data).enter().append("rect").attr("x",0).attr("y",function(a,e){return e*(c+b)+d}).attr("width",function(b){return a.xScale(b.avg_vocab)}).attr("height",c).style("fill",e)},drawSeparators:function(){var a=this,b=new Array(this.data.length+4-1),c="#BABABA",d=54.5,e=55;this.scaleContainer.selectAll("line").data(b).enter().append("line").attr("y1",function(a,b){return(b-4)*e+d}).attr("y2",function(a,b){return(b-4)*e+d}).attr("x1",0).attr("x2",function(){return a.xScale(6500)}).style("stroke",c).style("stroke-width",1)}}}(),!function(){Array.prototype.pushUniqueString=function(a){this.indexOf(a)>-1||this.push(a)},polyglotArtists={init:function(a,b){this.uniqueLanguages=this.getUniqueLanguages(b),this.config=a;var c=Handlebars.compile(a.template);a.container.append(c(b));var d=Handlebars.compile(a.languagesTemplate);a.languagesContainer.append(d(this.uniqueLanguages)),$(".polyglotImage").each(function(){$(this).on("mouseover",function(){var a=$(this).attr("id");b.forEach(function(b){var c="polyglot_"+b.name;a===c&&polyglotArtists.highlightLanguages(b.languages)})})}),$(".polyglotImage").on("mouseout",function(){$(".polyglotLanguage").each(function(){$(this).removeClass("languageHighlight")})})},getUniqueLanguages:function(a){var b=[];return a.forEach(function(a){a.languages.forEach(function(a){b.pushUniqueString(a)})}),b},highlightLanguages:function(a){a.forEach(function(a){polyglotArtists.config.languagesContainer.children("#"+a).addClass("languageHighlight")})}}}(),!function(){function a(a){this.config=a,this.data=this.config.data,this.$plot=$("#"+this.config.cssId),this.scale=d3.select("#"+this.config.scaleCssId),this.fontFamily="Oswald",this.width=this.$plot.width(),this.height=this.$plot.height(),this.artists={},this.addArtistsToPlot(),this.search.init(this,this.config.searchFieldCssId)}function b(a,b,d,e){$("#"+this.config.scaleCssId).children().remove();var f="#FFFFFF",g="#303030",h=25,i=.98*this.width,j=12;this.scale.selectAll("line").data(d).enter().append("line").attr("x1",h).attr("x2",i).attr("y1",function(b){return a(b)}).attr("y2",function(b){return a(b)}).style("stroke",f).style("stroke-width",1),this.scale.selectAll("text").data(d).enter().append("text").attr("x",h).attr("y",function(b){return a(b)-j}).text(function(a){return c(a)+b}).attr("fill",f).attr("font-size",18),e&&(this.scale.append("line").attr("x1",h).attr("x2",i).attr("y1",a(e)).attr("y2",a(e)).style("stroke",g).style("stroke-width",1),this.scale.append("text").text(c(e)+b).attr("fill",g).attr("font-size",16).attr("x",h).attr("y",a(e)-(j-5)),this.scale.append("text").text("Average").attr("fill",g).attr("font-size",16).attr("x",h).attr("y",a(e)-2.1*j))}function c(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}window.VocabPlot={},window.VocabPlot.formatWithCommas=c,window.VocabPlot.newPlot=function(b){return new a(b)},a.prototype={addArtistsToPlot:function(){var a=this;d3.select("#artistCircleContainer").selectAll(this.config.artistCircleCssClass).data(this.data).enter().append("div").attr("id",function(a){return a.name.split(" ").join("_")}).classed(this.config.artistCircleCssClass,!0).each(function(b){a.artists[b.name]=Artist.newArtist(b.name,b)}).transition().duration(300).style("opacity",1),this.arrangeByVocabulary()},arrangeByVocabulary:function(){var a=d3.scale.linear().domain([0,1e4]).range([this.height,0]);b.call(this,a," words",[809,2e3,4e3,6e3,8e3],2677),d3.select("#artistCircleContainer").selectAll("."+this.config.artistCircleCssClass).data(this.data).style("top",function(b){return a(b.vocab_len)-20+"px"}).style("left",function(a){return a.x+a.vocab_x_offset-17.5+"px"})},arrangeBySales:function(){var a=d3.scale.linear().domain([0,300]).range([this.height,0]);b.call(this,a,"M",[18.9,50,100,150,200,250]),d3.select("#artistCircleContainer").selectAll("."+this.config.artistCircleCssClass).data(this.data).style("top",function(b){return a(b.certified_sales)-20+"px"}).style("left",function(a){return a.x+a.sales_x_offset-17.5+"px"})},dimAllArtists:function(){for(var a in this.artists)this.artists[a].dim()},undimAllArtists:function(){for(var a in this.artists)this.artists[a].undim(),this.artists[a].unhighlight()},unhighlightAllArtists:function(){for(var a in this.artists)this.artists[a].unhighlight()},highlightArtists:function(a){var b=this;a.forEach(function(a){b.artists[a].highlight()})}},a.prototype.search={init:function(a,b){this.searchField=$("#"+b),this.plot=a,this.artistNames=Object.keys(this.plot.artists),this.searchField.autocomplete({source:[this.artistNames],highlight:!1,limit:8}),this.searchField.focus(function(){a.dimAllArtists();var b=a.$plot.offset();$("html, body").animate({scrollTop:b.top},200)}),this.searchField.blur(function(){a.undimAllArtists(),$(this).val("")});var c,d=this;this.searchField.keyup(function(a){clearTimeout(c),c=setTimeout(function(){return 27===a.keyCode?void d.searchField.blur():void d.highlightMatchingArtists()},250)})},highlightMatchingArtists:function(){var a=this,b=this.artistNames.filter(function(b){var c=a.searchField.val();return c?$.isNumeric(c)?a.plot.artists[b].data.rank_vocab===Number(c):0===b.toUpperCase().indexOf(c.toUpperCase()):void 0}).slice(0,8);this.plot.unhighlightAllArtists(),this.plot.highlightArtists(b)}}}(),!function(){"use strict";Handlebars.registerHelper("inc",function(a){return parseInt(a)+1}),Handlebars.registerHelper("undy",function(a){return a.split(" ").join("_")}),Handlebars.registerHelper("upperCase",function(a){return a.toUpperCase()}),vocab_data.forEach(function(a){a.x=$("#artistCircleContainer").width()/2}),VocabPlot.newPlot({cssId:"vocab_plot",scaleCssId:"vocab_plot_scale",searchFieldCssId:"locateArtist",artistCircleCssClass:"artistContainer",data:vocab_data}),AllArtists.createChart({allChartCssId:"allArtistsContainer"},genre_data),$(".letterArtistImage").each(function(){var a=$(this);a.tipsy({title:function(){return a.attr("id").split("_").join(" ")},gravity:"s",opacity:1,offset:0})}),expandButton.init({button:$("#btn_expandList"),target:$("#allArtistsContainer")});var a=[{name:"Julio_Iglesias",languages:["Spanish","German","English","French","Italian","Portuguese","Russian"]},{name:"Andrea_Bocelli",languages:["Spanish","English","French","Italian","Portuguese"]},{name:"Bz",languages:["Japanese","English"]},{name:"Gloria_Estefan",languages:["English","Spanish","French"]}];polyglotArtists.init({container:$("#polyglotImages"),languageContainer:$("#polyglotLanguages"),languagesContainer:$("#polyglotLanguages"),template:$("#template-polyglots").html(),languagesTemplate:$("#template-polyglots-languages").html(),artistContainer:$(".polyglotImage")},a),$(".polyglotImage:last-child").wrap("<center></center>"),$(".polyglotImage").eq(0).css("margin-left","0"),GenrePlot.init({container:$("#genrePlot"),scaleContainerCssId:"genrePlotScale",legendContainerCssId:"genreLegend",namesContainer:$("#genreNames"),genreNameTemplate:$("#genre-names-template").html()})}();