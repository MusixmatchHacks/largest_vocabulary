!function(){function t(t,r){this.data=r,r.sort(e("num_artists")),this.$chart=$("#"+t.allChartCssId),this.addArtistsToChart()}function r(t){return t.split(" ").join("_")}function e(t){return function(r,e){if("object"==typeof r&&"object"==typeof e){var n=r[t],s=e[t];return n===s?0:typeof propetyValueM==typeof propertyVaueN?s>n?1:-1:s>typeof n?1:-1}throw{type:"Error",message:"Expected objects got something else"}}}window.AllArtists={},window.AllArtists.createChart=function(r,e){return new t(r,e)},t.prototype={sortNames:function(t){t.sort();var e=[],n=t[0][0],s=0;return t.forEach(function(t){t[0]===n?0===e.length?e.push({startingLetter:n,names:[r(t)]}):e[s].names.push(r(t)):(n=t[0],s++,e[s]={startingLetter:n,names:[r(t)]})}),e},addArtistsToChart:function(){var t=Handlebars.compile(this.$chart.children("#template-allArtists").html());this.$chart.append(t(this.data))}}}();
;!function(){function t(t,i){this.name=t,this.data=i,this.selector=t.split(" ").join("_"),this.$artist=$("#"+this.selector),this.$artist.css("background-image","url(img/artist_images_40px/"+this.selector+".jpg)"),this.tooltipTemplate=$.trim($("#tooltipTemplate").html()),this.numArtists=93,this.tooltipStates={COMPACT:1,EXPANDED:2},this.currentTooltipState=this.tooltipStates.COMPACT,this.tooltipOriginalContent=$("#tooltipTemplate").html().replace(/{{rank}}/i,this.data.rank_vocab).replace(/{{artistName}}/i,"The Black Eyed Peas"===this.data.name?"T.B.E.P":this.data.name).replace(/{{vocab}}/i,window.VocabPlot.formatWithCommas(this.data.vocab_len)).replace(/{{total}}/i,this.numArtists),this.tooltipExpandedContent=$("#tooltipTemplateExpanded").html().replace(/{{rank}}/i,this.data.rank_vocab).replace(/{{artistName}}/i,"The Black Eyed Peas"===this.data.name?"T.B.E.P":this.data.name).replace(/{{vocab}}/i,window.VocabPlot.formatWithCommas(this.data.vocab_len)).replace(/{{total}}/i,this.numArtists).replace(/{{sales}}/i,this.data.certified_sales).replace(/{{rank_sales}}/i,this.data.rank_sales).replace(/{{learning_rate}}/i,Math.floor(this.data.learning_rate)),this.events.hover.call(this),this.events.click.call(this)}window.Artist={},window.Artist.newArtist=function(i,a){return new t(i,a)},t.prototype={dim:function(){this.$artist.removeClass("normalArtist"),this.$artist.addClass("dimArtist")},undim:function(){this.$artist.removeClass("dimArtist"),this.$artist.addClass("normalArtist")},highlight:function(){this.$artist.hasClass("highlightedArtist")||(this.$artist.addClass("highlightedArtist"),this.$artist.tipsy("show"))},unhighlight:function(){this.$artist.hasClass("highlightedArtist")&&(this.$artist.removeClass("highlightedArtist"),this.$artist.tipsy("hide"))}},t.prototype.events={click:function(){},hover:function(){var t=this;this.$artist.tipsy({gravity:"Eminem"===t.data.name?"n":"s",html:!0,opacity:1,offset:3,title:function(){return t.tooltipExpandedContent}})}}}();
;!function(){var t=$(window);expandButton={init:function(t){this.button=t.button,this.target=t.target,this.initialButtonPos=this.button.offset(),this.scrollLimits=this.target.offset(),this.button.on("click",this.expandListToggle)},expandListToggle:function(){expandButton.target.toggleClass("expanded"),expandButton.target.hasClass("expanded")?(expandButton.target.children(".overlay").remove(),$(this).text("Show less")):(expandButton.target.prepend($("<div></div>",{"class":"overlay"})),$(this).text("Show all"),t.scrollTop()>expandButton.getLowerScrollLimit()&&t.scrollTop(1100))},getUpperScrollLimit:function(){return this.scrollLimits.top},getLowerScrollLimit:function(){return this.scrollLimits.top+this.target.height()-this.button.height()-100}},t.on("scroll",function(){var o=t.scrollTop();o>expandButton.getUpperScrollLimit()&&o<expandButton.getLowerScrollLimit()?(expandButton.button.addClass("buttonFixedScroll"),expandButton.button.css({top:expandButton.initialButtonPos.top-452+"px",left:expandButton.initialButtonPos.left+"px"})):(expandButton.button.removeClass("buttonFixedScroll"),expandButton.button.offset(expandButton.initialButtonPos))})}();
;!function(){function t(t){return function(e,n){if("object"==typeof e&&"object"==typeof n){var a=e[t],r=n[t];return a===r?0:typeof propetyValueM==typeof propertyVaueN?r>a?1:-1:r>typeof a?1:-1}throw{type:"Error",message:"Expected objects got something else"}}}window.GenrePlot={init:function(e){this.data=genre_data,this.data.sort(t("avg_vocab")),this.container=e.container,this.scaleContainer=d3.select("#"+e.scaleContainerCssId),this.legendContainer=d3.select("#"+e.legendContainerCssId),this.xScale=d3.scale.linear().domain([0,d3.max(this.data,function(t){return t.avg_vocab})]).range([0,$("#"+e.scaleContainerCssId).width()]),e.namesContainer.append(Handlebars.compile(e.genreNameTemplate)(this.data)),this.scaleContainer.style("height",this.container.height()+"px"),this.drawPlot([500,2e3,3500,5e3]);var n=$(window),a=$("#"+e.legendContainerCssId),r=a.offset(),i=this;n.on("scroll",function(){var t=i.container.offset(),e=t.top,o=e+i.container.height()-30,s=n.scrollTop();s>e&&o>s?a.css({position:"fixed",top:"30px",left:r.left}):a.css({position:"absolute",top:t.top-220})})},drawPlot:function(t){this.drawBars(),this.drawScale(t),this.drawSeparators(),this.drawScaleLegend(t)},drawScale:function(t){var e=this,n="#303030";this.scaleContainer.selectAll("line").data(t).enter().append("line").attr("x1",function(t){return e.xScale(t)}).attr("x2",function(t){return e.xScale(t)}).attr("y1",0).attr("y2",this.container.height()).style("stroke",n).style("stroke-width",1)},drawScaleLegend:function(t){var e=this,n=100,a=30,r="#303030",i="#FFFFFF",o=8;this.legendContainer.selectAll("rect").data(t).enter().append("rect").attr("x",function(t){return e.xScale(t)-.5}).attr("y",0).attr("width",n).attr("height",a).style("fill",r),this.legendContainer.selectAll("text").data(t).enter().append("text").attr("x",function(t){return e.xScale(t)+o}).attr("y",21).text(function(t){return t+" WORDS"}).attr("fill",i).style("font-family","Oswald")},drawBars:function(){var t=this,e=25,n=30,a=13,r="#D6C06D";this.scaleContainer.selectAll("rect").data(this.data).enter().append("rect").attr("x",0).attr("y",function(t,r){return r*(n+e)+a}).attr("width",function(e){return t.xScale(e.avg_vocab)}).attr("height",n).style("fill",r)},drawSeparators:function(){var t=this,e=new Array(this.data.length+4-1),n="#BABABA",a=54.5,r=55;this.scaleContainer.selectAll("line").data(e).enter().append("line").attr("y1",function(t,e){return(e-4)*r+a}).attr("y2",function(t,e){return(e-4)*r+a}).attr("x1",0).attr("x2",function(e){return t.xScale(6500)}).style("stroke",n).style("stroke-width",1)}}}();
;!function(){Array.prototype.pushUniqueString=function(n){this.indexOf(n)>-1||this.push(n)},polyglotArtists={init:function(n,a){this.uniqueLanguages=this.getUniqueLanguages(a),this.config=n;var t=Handlebars.compile(n.template);n.container.append(t(a));var i=Handlebars.compile(n.languagesTemplate);n.languagesContainer.append(i(this.uniqueLanguages)),$(".polyglotImage").each(function(){$(this).on("mouseover",function(){var n=$(this).attr("id");a.forEach(function(a){var t="polyglot_"+a.name;n===t&&polyglotArtists.highlightLanguages(a.languages)})})}),$(".polyglotImage").on("mouseout",function(){$(".polyglotLanguage").each(function(){$(this).removeClass("languageHighlight")})})},getUniqueLanguages:function(n){var a=[];return n.forEach(function(n){n.languages.forEach(function(n){a.pushUniqueString(n)})}),a},highlightLanguages:function(n){n.forEach(function(n){polyglotArtists.config.languagesContainer.children("#"+n).addClass("languageHighlight")})}}}();
;!function(){function t(t){this.config=t,this.data=this.config.data,this.$plot=$("#"+this.config.cssId),this.scale=d3.select("#"+this.config.scaleCssId),this.fontFamily="Oswald",this.width=this.$plot.width(),this.height=this.$plot.height(),this.artists={},this.addArtistsToPlot(),this.search.init(this,this.config.searchFieldCssId)}function i(t,i,e,a){$("#"+this.config.scaleCssId).children().remove();var r="#FFFFFF",n="#303030",l=25,h=.98*this.width,o=12;this.scale.selectAll("line").data(e).enter().append("line").attr("x1",l).attr("x2",h).attr("y1",function(i){return t(i)}).attr("y2",function(i){return t(i)}).style("stroke",r).style("stroke-width",1),this.scale.selectAll("text").data(e).enter().append("text").attr("x",l).attr("y",function(i){return t(i)-o}).text(function(t){return s(t)+i}).attr("fill",r).attr("font-size",18),a&&(this.scale.append("line").attr("x1",l).attr("x2",h).attr("y1",t(a)).attr("y2",t(a)).style("stroke",n).style("stroke-width",1),this.scale.append("text").text(s(a)+i).attr("fill",n).attr("font-size",16).attr("x",l).attr("y",t(a)-(o-5)),this.scale.append("text").text("Average").attr("fill",n).attr("font-size",16).attr("x",l).attr("y",t(a)-2.1*o))}function s(t){var i=t.toString().split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")}window.VocabPlot={},window.VocabPlot.formatWithCommas=s,window.VocabPlot.newPlot=function(i){return new t(i)},t.prototype={addArtistsToPlot:function(){var t=this;d3.select("#artistCircleContainer").selectAll(this.config.artistCircleCssClass).data(this.data).enter().append("div").attr("id",function(t){return t.name.split(" ").join("_")}).classed(this.config.artistCircleCssClass,!0).each(function(i){t.artists[i.name]=Artist.newArtist(i.name,i)}).transition().duration(300).style("opacity",1),this.arrangeByVocabulary()},arrangeByVocabulary:function(){var t=d3.scale.linear().domain([0,1e4]).range([this.height,0]);i.call(this,t," words",[809,2e3,4e3,6e3,8e3],2677),d3.select("#artistCircleContainer").selectAll("."+this.config.artistCircleCssClass).data(this.data).style("top",function(i){return t(i.vocab_len)-20+"px"}).style("left",function(t){return t.x+t.vocab_x_offset-17.5+"px"})},arrangeBySales:function(){var t=d3.scale.linear().domain([0,300]).range([this.height,0]);i.call(this,t,"M",[18.9,50,100,150,200,250]),d3.select("#artistCircleContainer").selectAll("."+this.config.artistCircleCssClass).data(this.data).style("top",function(i){return t(i.certified_sales)-20+"px"}).style("left",function(t,i){return t.x+t.sales_x_offset-17.5+"px"})},dimAllArtists:function(){for(var t in this.artists)this.artists[t].dim()},undimAllArtists:function(){for(var t in this.artists)this.artists[t].undim(),this.artists[t].unhighlight()},unhighlightAllArtists:function(){for(var t in this.artists)this.artists[t].unhighlight()},highlightArtists:function(t){var i=this;t.forEach(function(t){i.artists[t].highlight()})}},t.prototype.search={init:function(t,i){this.searchField=$("#"+i),this.plot=t,this.artistNames=Object.keys(this.plot.artists),this.searchField.autocomplete({source:[this.artistNames],highlight:!1,limit:8}),this.searchField.focus(function(){t.dimAllArtists();var i=t.$plot.offset();$("html, body").animate({scrollTop:i.top},200)}),this.searchField.blur(function(){t.undimAllArtists(),$(this).val("")});var s,e=this;this.searchField.keyup(function(t){clearTimeout(s),s=setTimeout(function(){return 27===t.keyCode?void e.searchField.blur():void e.highlightMatchingArtists()},250)})},highlightMatchingArtists:function(){var t=this,i=this.artistNames.filter(function(i){var s=t.searchField.val();return s?$.isNumeric(s)?t.plot.artists[i].data.rank_vocab===Number(s):0===i.toUpperCase().indexOf(s.toUpperCase()):void 0}).slice(0,8);this.plot.unhighlightAllArtists(),this.plot.highlightArtists(i)}}}();
;!function(){"use strict";Handlebars.registerHelper("inc",function(e,t){return parseInt(e)+1}),Handlebars.registerHelper("undy",function(e,t){return e.split(" ").join("_")}),Handlebars.registerHelper("upperCase",function(e,t){return e.toUpperCase()}),vocab_data.forEach(function(e,t){e.x=$("#artistCircleContainer").width()/2});VocabPlot.newPlot({cssId:"vocab_plot",scaleCssId:"vocab_plot_scale",searchFieldCssId:"locateArtist",artistCircleCssClass:"artistContainer",data:vocab_data}),AllArtists.createChart({allChartCssId:"allArtistsContainer"},genre_data);$(".letterArtistImage").each(function(){var e=$(this);e.tipsy({title:function(){return e.attr("id").split("_").join(" ")},gravity:"s",opacity:1,offset:0})}),expandButton.init({button:$("#btn_expandList"),target:$("#allArtistsContainer")});var e=[{name:"Julio_Iglesias",languages:["Spanish","German","English","French","Italian","Portuguese","Russian"]},{name:"Andrea_Bocelli",languages:["Spanish","English","French","Italian","Portuguese"]},{name:"Bz",languages:["Japanese","English"]},{name:"Gloria_Estefan",languages:["English","Spanish","French"]}];polyglotArtists.init({container:$("#polyglotImages"),languageContainer:$("#polyglotLanguages"),languagesContainer:$("#polyglotLanguages"),template:$("#template-polyglots").html(),languagesTemplate:$("#template-polyglots-languages").html(),artistContainer:$(".polyglotImage")},e),$(".polyglotImage:last-child").wrap("<center></center>"),$(".polyglotImage").eq(0).css("margin-left","0"),GenrePlot.init({container:$("#genrePlot"),scaleContainerCssId:"genrePlotScale",legendContainerCssId:"genreLegend",namesContainer:$("#genreNames"),genreNameTemplate:$("#genre-names-template").html()})}();
